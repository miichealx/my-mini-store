<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>📊 لوحة التحكم - Mini Store</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    body { background:#f8f9fa; }
    .navbar { background:#0d6efd; }
    .navbar-brand, .nav-link { color:#fff !important; font-weight:600; }
    .card { border-radius:15px; box-shadow:0 5px 18px rgba(0,0,0,0.08); text-align:center; }
    .card h2 { font-size:2rem; margin:10px 0; }
    footer { background:#0d6efd; color:#fff; text-align:center; padding:10px; margin-top:30px; }
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg mb-4">
    <div class="container">
      <a class="navbar-brand" href="index.html">🏪 Mini Store Dashboard</a>
      <div class="d-flex gap-2">
        <a class="btn btn-light btn-sm" href="admin.html">إدارة المنتجات</a>
        <a class="btn btn-outline-light btn-sm" href="index.html">عرض الموقع</a>
      </div>
    </div>
  </nav>

  <!-- Dashboard -->
  <div class="container">
    <h3 class="text-center mb-4">لوحة تحكم المبيعات 💼</h3>

    <div class="row g-4 justify-content-center">
      <div class="col-md-3">
        <div class="card p-4">
          <h5>عدد المنتجات</h5>
          <h2 id="totalProducts">0</h2>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card p-4">
          <h5>عدد الطلبات</h5>
          <h2 id="totalOrders">0</h2>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card p-4">
          <h5>عدد العملاء</h5>
          <h2 id="totalCustomers">0</h2>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card p-4">
          <h5>إجمالي المبيعات 💰</h5>
          <h2 id="totalSales">$0</h2>
        </div>
      </div>
    </div>
  </div>

  <footer>© 2025 Mini Store Dashboard</footer>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.13.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.13.0/firebase-database-compat.js"></script>

  <script>
    // 🔥 بيانات مشروعك من Firebase (نفسها في باقي الصفحات)
    const firebaseConfig = {
      apiKey: "REPLACE_WITH_YOUR_APIKEY",
      authDomain: "REPLACE_WITH_YOUR_AUTHDOMAIN",
      databaseURL: "REPLACE_WITH_YOUR_DATABASEURL",
      projectId: "REPLACE_WITH_YOUR_PROJECTID",
      storageBucket: "REPLACE_WITH_YOUR_STORAGEBUCKET",
      messagingSenderId: "REPLACE_WITH_YOUR_MESSAGINGSENDERID",
      appId: "REPLACE_WITH_YOUR_APPID"
    };

    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    // عناصر الصفحة
    const totalProducts = document.getElementById('totalProducts');
    const totalOrders = document.getElementById('totalOrders');
    const totalCustomers = document.getElementById('totalCustomers');
    const totalSales = document.getElementById('totalSales');

    // 🧮 تحميل البيانات
    function loadDashboard() {
      // عدد المنتجات
      database.ref('products').on('value', (snapshot) => {
        const data = snapshot.val();
        totalProducts.textContent = data ? Object.keys(data).length : 0;
      });

      // الطلبات
      database.ref('orders').on('value', (snapshot) => {
        const data = snapshot.val();
        if (!data) {
          totalOrders.textContent = 0;
          totalCustomers.textContent = 0;
          totalSales.textContent = '$0';
          return;
        }

        const orders = Object.values(data);
        totalOrders.textContent = orders.length;

        // عدد العملاء الفريدين
        const uniqueCustomers = new Set(orders.map(o => o.email));
        totalCustomers.textContent = uniqueCustomers.size;

        // إجمالي المبيعات
        const total = orders.reduce((sum, o) => sum + (Number(o.total) || 0), 0);
        totalSales.textContent = '$' + total.toFixed(2);
      });
    }

    document.addEventListener('DOMContentLoaded', loadDashboard);
  </script>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
